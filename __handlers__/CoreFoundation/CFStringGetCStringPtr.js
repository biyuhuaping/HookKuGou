/*
 * Auto-generated by Frida. Please modify to match the signature of CFStringGetCStringPtr.
 * This stub is currently auto-generated from manpages when available.
 *
 * For full API reference, see: https://frida.re/docs/javascript-api/
 */

// __handlers__/CFStringGetCStringPtr.js
defineHandler({
  onEnter(log, args, state) {
    // args[0] æ˜¯ CFStringRef
    // args[1] æ˜¯ç¼–ç å‚æ•°
    var cfString = args[0];
    var encoding = args[1];
    
    // å°† CFStringRef è½¬æ¢ä¸º JavaScript å­—ç¬¦ä¸²
    var stringContent = Memory.readUtf8String(cfString);
    
    log('CFStringGetCStringPtr()');
    log('å­—ç¬¦ä¸²å†…å®¹:2 ' + stringContent);
    log('ç¼–ç : ' + encoding);
    log('æŒ‡é’ˆåœ°å€: ' + cfString);
    
    // æ£€æŸ¥æ˜¯å¦åŒ…å« IDFA ç›¸å…³å…³é”®è¯
    if (stringContent && (stringContent.includes('IDFA') || 
                         stringContent.includes('idfa') || 
                         stringContent.includes('advertising') ||
                         stringContent.length === 36)) {
        log('ğŸš¨ æ£€æµ‹åˆ°å¯èƒ½çš„ IDFA ç›¸å…³å­—ç¬¦ä¸²!');
    }
  },

  onLeave(log, retval, state) {
    // log('è¿”å›å€¼: ' + retval);
  }
});
