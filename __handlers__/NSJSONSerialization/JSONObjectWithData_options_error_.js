/*
 * Auto-generated by Frida. Please modify to match the signature of +[NSJSONSerialization JSONObjectWithData:options:error:].
 * This stub is currently auto-generated from manpages when available.
 *
 * For full API reference, see: https://frida.re/docs/javascript-api/
 */

//frida-trace -U -f com.kugou.kugou1002 -m "+[NSJSONSerialization JSONObjectWithData:options:error:]" -o resp.json

defineHandler({
  onEnter(log, args, state) {
    // log(`+[NSJSONSerialization JSONObjectWithData:${args[2]} options:${args[3]} error:${args[4]}]`);
    // this.args2 = args[2];
    // log("ğŸ‘‰ NSData -> JSON å‡ºå‚:" + ObjC.Object(args[2]));
    // log(Thread.backtrace(this.context, Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join('\n'));
    // log('------------------------------------------------------------------------------------------------');
  },

  onLeave(log, retval, state) {
    const dic = ObjC.Object(retval);
    // log("ğŸ‘‰  ->" + dic + dic.$className);
    // log("ğŸ‘‰  ->" + dic.allKeys());
    // // ä»…å½“å­—å…¸åŒ…å« key "q36" æ—¶è¿›å…¥
    const key = ObjC.classes.NSString.stringWithString_("q36");

    // log("ğŸ‘‰ allkeys:" + allkeys);
    if (dic.objectForKey_(key) !== null) {
      log("ğŸ‘‰ NSData -> JSON å‡ºå‚:" + dic);
      log(Thread.backtrace(this.context, Backtracer.ACCURATE).map(DebugSymbol.fromAddress).join('\n'));
    }
  }
});