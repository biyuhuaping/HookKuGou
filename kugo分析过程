âœ…
  7639 ms  -[KGTencentStatistics forceRereshDeviceIDMachineName:0x2802b9b40 o36:0x2802b9b40]
  7639 ms  ğŸ‘‰1482ec024f1effab71edd705000016319904ï¼ˆ__NSCFStringï¼‰
  7639 ms  ğŸ‘‰1482ec024f1effab71edd705000016319904ï¼ˆ__NSCFStringï¼‰
  7639 ms  stack: 0x10bc607e8 kugou!-[KGTencentStatistics update:o36:]
0x102f0c820 kugou!-[OstarService updateO16:o36:]
0x102ee5ac4 kugou!-[Qmeiegtm qmei_evkj6p0:]
0x102ee7aac kugou!-[Qmeiegtm qmei_qrlegk:serverCode:]
0x102ee7518 kugou!-[Qmeiegtm qmei_e948ze8:code:]
0x102f01af4 kugou!0xb9af4 (0x1000b9af4)
0x10fa85570 kugou!0xcc3d570 (0x10cc3d570)
0x102ecaa2c kugou!0x82a2c (0x100082a2c)
0x102eca2a0 kugou!0x822a0 (0x1000822a0)
0x10bc6076c kugou!0x8e1876c (0x108e1876c)
0x190f8b7a8 libdispatch.dylib!_dispatch_call_block_and_release
0x190f8c780 libdispatch.dylib!_dispatch_client_callout
0x190f6de10 libdispatch.dylib!_dispatch_main_queue_drain
0x190f6da88 libdispatch.dylib!_dispatch_main_queue_callback_4CF$VARIANT$armv81
0x18a26d9ac CoreFoundation!__CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__
0x18a251648 CoreFoundation!__CFRunLoopRun
  9225 ms  ğŸ‘ˆ: 1482ec024f1effab71edd705000016319904ï¼ˆ__NSCFStringï¼‰


  8726 ms  -[OstarService updateO16:0x283727080 o36:0x283727080]
  8726 ms  stack: 0x100511ac4 kugou!-[Qmeiegtm qmei_evkj6p0:]
0x100513aac kugou!-[Qmeiegtm qmei_qrlegk:serverCode:]
0x100513518 kugou!-[Qmeiegtm qmei_e948ze8:code:]
0x10052daf4 kugou!0xb9af4 (0x1000b9af4)
0x10d0b1570 kugou!0xcc3d570 (0x10cc3d570)
0x1004f6a2c kugou!0x82a2c (0x100082a2c)
0x1004f62a0 kugou!0x822a0 (0x1000822a0)
0x10928c76c kugou!0x8e1876c (0x108e1876c)
0x190f8b7a8 libdispatch.dylib!_dispatch_call_block_and_release
0x190f8c780 libdispatch.dylib!_dispatch_client_callout
0x190f6de10 libdispatch.dylib!_dispatch_main_queue_drain
0x190f6da88 libdispatch.dylib!_dispatch_main_queue_callback_4CF$VARIANT$armv81
0x18a26d9ac CoreFoundation!__CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__
0x18a251648 CoreFoundation!__CFRunLoopRun
0x18a255d20 CoreFoundation!CFRunLoopRunSpecific
0x1c2325998 GraphicsServices!GSEventRunModal
 10227 ms  ğŸ‘ˆ: 1482ec024f1effab71edd705000016319904ï¼ˆ__NSCFStringï¼‰



-[QimeiContent setQimeiOld:0x2801fc440]
è°ƒç”¨æ ˆ:
0x104350270 kugou!-[OstarService startWithO16:o36:delegate:]
0x1042dc33c kugou!-[KGTencentStatistics setUpOStar]
0x1042dbfd8 kugou!-[KGTencentStatistics setUpTencentStatics]
0x1042da39c kugou!0x4e39c (0x10004e39c)
0x190f8c780 libdispatch.dylib!_dispatch_client_callout
0x190f5cddc libdispatch.dylib!_dispatch_once_callout
0x1042da324 kugou!+[KGAutoTrackTask setupStatics]
0x10cd7cb34 kugou!-[KGStartUpTaskManager pTaskObjectperform:queueKey:]
0x10cd7b974 kugou!0x8aef974 (0x108aef974)
0x10cd7a30c kugou!-[KGStartUpTaskSysQueue runTasks:]
0x10cd7c84c kugou!-[KGStartUpTaskManager pRunQueueWithTasks:queueKey:]
0x10cd7aff0 kugou!-[KGStartUpTaskManager pRunWithQueueKey:]
0x1045c250c kugou!0x33650c (0x10033650c)
0x10bbbc74c kugou!-[KGPrivacyPolicySheetViewManager showPrivacyPolicyLaunchFromBasicMode:withOkBlock:]
0x1045c2454 kugou!0x336454 (0x100336454)
0x1045c0ee0 kugou!-[SceneDelegate scene:willConnectToSession:options:]


0x1001b7fd8 kugou!-[KGTencentStatistics setUpTencentStatics]
0x1001b639c kugou!0x4e39c (0x10004e39c)
0x190f8c780 libdispatch.dylib!_dispatch_client_callout
0x190f5cddc libdispatch.dylib!_dispatch_once_callout
0x1001b6324 kugou!+[KGAutoTrackTask setupStatics]
0x108c58b34 kugou!-[KGStartUpTaskManager pTaskObjectperform:queueKey:]
0x108c57974 kugou!0x8aef974 (0x108aef974)
0x108c5630c kugou!-[KGStartUpTaskSysQueue runTasks:]
0x108c5884c kugou!-[KGStartUpTaskManager pRunQueueWithTasks:queueKey:]
0x108c56ff0 kugou!-[KGStartUpTaskManager pRunWithQueueKey:]
0x10049e50c kugou!0x33650c (0x10033650c)
0x107a9874c kugou!-[KGPrivacyPolicySheetViewManager showPrivacyPolicyLaunchFromBasicMode:withOkBlock:]
0x10049e454 kugou!0x336454 (0x100336454)
0x10049cee0 kugou!-[SceneDelegate scene:willConnectToSession:options:]


  8015 ms  -[Qmeiegtm qmei_tc50i0:0x0 newQimei:0x281949c60]
  8015 ms  ğŸ‘‰nilï¼ˆnilï¼‰
  8015 ms  ğŸ‘‰<QimeiContent: 0x281949c60>ï¼ˆQimeiContentï¼‰
  8015 ms  stack: 0x1049d7a78 kugou!-[Qmeiegtm qmei_qrlegk:serverCode:]
0x1049d7518 kugou!-[Qmeiegtm qmei_e948ze8:code:]
0x1049f1af4 kugou!0xb9af4 (0x1000b9af4)
0x111575570 kugou!0xcc3d570 (0x10cc3d570)
0x1049baa2c kugou!0x82a2c (0x100082a2c)
0x1049ba2a0 kugou!0x822a0 (0x1000822a0)
0x10d75076c kugou!0x8e1876c (0x108e1876c)
0x190f8b7a8 libdispatch.dylib!_dispatch_call_block_and_release
0x190f8c780 libdispatch.dylib!_dispatch_client_callout
0x190f6de10 libdispatch.dylib!_dispatch_main_queue_drain
0x190f6da88 libdispatch.dylib!_dispatch_main_queue_callback_4CF$VARIANT$armv81
0x18a26d9ac CoreFoundation!__CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__
0x18a251648 CoreFoundation!__CFRunLoopRun
0x18a255d20 CoreFoundation!CFRunLoopRunSpecific
0x1c2325998 GraphicsServices!GSEventRunModal
0x18c4e834c UIKitCore!-[UIApplication _run]
  9472 ms  ğŸ‘ˆ: nil nil



           /* TID 0x103 */
  2289 ms  ğŸ‘‰ undefined
  2289 ms  ğŸ‘‰ undefined
  2289 ms  stack: 0x100cfdb38 kugou!0xb9b38 (0x1000b9b38)
0x10d9505c0 kugou!0xcd0c5c0 (0x10cd0c5c0)
0x100cc6a70 kugou!0x82a70 (0x100082a70)
0x100cc62e4 kugou!0x822e4 (0x1000822e4)
0x109aee734 kugou!0x8eaa734 (0x108eaa734)
0x190f8b7a8 libdispatch.dylib!_dispatch_call_block_and_release
0x190f8c780 libdispatch.dylib!_dispatch_client_callout
0x190f6de10 libdispatch.dylib!_dispatch_main_queue_drain
0x190f6da88 libdispatch.dylib!_dispatch_main_queue_callback_4CF$VARIANT$armv81
0x18a26d9ac CoreFoundation!__CFRUNLOOP_IS_SERVICING_THE_MAIN_DISPATCH_QUEUE__
0x18a251648 CoreFoundation!__CFRunLoopRun
0x18a255d20 CoreFoundation!CFRunLoopRunSpecific
0x1c2325998 GraphicsServices!GSEventRunModal
0x18c4e834c UIKitCore!-[UIApplication _run]
0x18c4e7fc4 UIKitCore!UIApplicationMain
0x100c74e8c kugou!0x30e8c (0x100030e8c)
  4974 ms  -[Qmeiegtm qmei_e948ze8:retval


# mark --------------
0x119f64e1c KGThirdParty!+[UICKeyChainStore setString:forKey:]
0x1084053f4 kugou!-[KGDeviceFPManager setDeviceFingerprintID:]
0x108407ed0 kugou!0x547fed0 (0x10547fed0)
0x190f8b7a8 libdispatch.dylib!_dispatch_call_block_and_release
0x190f8c780 libdispatch.dylib!_dispatch_client_callout
0x190f676fc libdispatch.dylib!_dispatch_lane_serial_drain$VARIANT$armv81
0x190f681b0 libdispatch.dylib!_dispatch_lane_invoke$VARIANT$armv81
0x190f71f14 libdispatch.dylib!_dispatch_workloop_worker_thread
0x1d4f8abd0 libsystem_pthread.dylib!_pthread_wqthread



âœ…æ£€æµ‹è¶Šç‹±
-[CacheDeleteVolume validate]
+[KGCommonTools isPerfectJailBroken]
+[KGDeviceFPManager detectGRootByGRootFileExisted]
+[KGDeviceFPManager detectCurrentDeviceIsGRoot]
+ (BOOL)detectCurrentDeviceIsGRoot{
    // self å­˜åœ¨äº X0 â†’ å­˜åˆ° X19
    id selfObj = self;

    // 1. æ£€æµ‹ GRoot File
    if ([selfObj detectGRootByGRootFileExisted]) {
        return YES;
    }

    // 2. æ£€æµ‹ Cydia è·¯å¾„æ˜¯å¦å­˜åœ¨
    if ([selfObj detectGRootByCydiaPathExisted]) {
        return YES;
    }

    // 3. æ£€æµ‹ stat ç³»ç»Ÿè°ƒç”¨ï¼ˆä¾‹å¦‚ /bin/bash æˆ– /usr/sbin/sshd æ˜¯å¦å¯ statï¼‰
    if ([selfObj detectGRootByStat]) {
        return YES;
    }

    // 4. æ£€æµ‹ AppPath æ˜¯å¦å¼‚å¸¸ï¼ˆæ˜¯å¦è¿è¡Œåœ¨è¶Šç‹±å®¹å™¨ï¼‰
    if ([selfObj detectGRootByAppPathExisted]) {
        return YES;
    }

    // 5. å¦‚æœä¸Šè¿°å…¨éƒ½æ²¡æœ‰å‘½ä¸­ï¼Œæœ€ç»ˆè°ƒç”¨ detectGRootByEnvironmentExisted
    //    å¦‚æœ detectGRootByEnvironmentExisted è¿”å› YES â†’ è®¤ä¸ºè¶Šç‹±
    return [selfObj detectGRootByEnvironmentExisted];
}

âœ…
-[KGDeviceFPManager setDeviceFingerprintID:]
// å¾—åˆ° 1stg4N3Oz1xX2G0LS10bHT9Kï¼ˆ__NSCFStringï¼‰
- (void)setDeviceFingerprintID:(NSString *)deviceFingerprintID {
    // å¯¹åº”æ±‡ç¼–å¼€å§‹ï¼šå…ˆç”¨ __HippyI18nUtils_copy__0 å¯¹ä¼ å…¥å‚æ•°åš copyï¼ˆé˜²æ­¢è¢«å¤–éƒ¨ä¿®æ”¹ï¼‰
    NSString *copied = [HippyI18nUtils copy:deviceFingerprintID];

    // è‹¥ copy ç»“æœä¸º nilï¼Œä½¿ç”¨äºŒè¿›åˆ¶é‡Œçš„é»˜è®¤å¸¸é‡ï¼ˆstru_10F8E5610ï¼‰
    // è¿™é‡Œç”¨ä¸€ä¸ªå ä½é»˜è®¤å€¼æ–¹æ³• defaultDeviceFingerprintID
    NSString *valueToUse = (copied != nil) ? copied : [KGDeviceFPManager defaultDeviceFingerprintID];

    // å†™å…¥ ConfigProtocolï¼ˆé™æ€/å…¨å±€å­˜å‚¨ï¼‰
    [ConfigProtocol setDeviceFingerprintID:valueToUse];

    // åŒæ­¥å†™å…¥é’¥åŒ™ä¸²ï¼ˆkey ä¸æ±‡ç¼–ä¸€è‡´ï¼‰
    [UICKeyChainStore setString:valueToUse forKey:@"DeviceFingerprintID"];

    // ä¸‹åˆ—é€»è¾‘å¯¹åº”æ±‡ç¼–å¯¹å®ä¾‹ ivar çš„åŸå­æ£€æŸ¥ä¸æ›´æ–°ï¼š
    // - å¦‚æœå½“å‰ ivar é nilï¼Œè·³è¿‡ç¬¬ä¸€æ®µå†™å…¥ï¼ˆè§æ±‡ç¼–çš„ CBNZ / isEmptyStr æ£€æŸ¥ï¼‰
    // - å¦åˆ™ï¼Œå½“æ–°å€¼éç©ºä¸”ä¸æ—§å€¼ä¸åŒï¼Œå†™å…¥ self->_deviceFingerprintIDï¼ˆobjc_storeStrong ç­‰ä»·ï¼‰
    //
    // æ±‡ç¼–ä½¿ç”¨ objc_sync_enter/exitï¼Œç­‰ä»·å†™æ³•ç”¨ @synchronized(self)
    @synchronized (self) {
        // å¦‚æœæ–°å€¼ä¸ºç©ºï¼ˆStringTool çš„ isEmptyStrï¼‰ï¼Œä¸è¿›è¡Œæ›¿æ¢
        BOOL isEmpty = [StringTool isEmptyStr:valueToUse];
        if (!isEmpty) {
            NSString *current = self.deviceFingerprintID;
            // å¦‚æœå½“å‰ä¸ºç©ºæˆ–è€…ä¸æ–°å€¼ä¸åŒï¼Œåˆ™æ›´æ–°
            if (current == nil || ![current isEqualToString:valueToUse]) {
                self.deviceFingerprintID = valueToUse; // ç­‰åŒäº objc_storeStrong(location, value)
            }
        }
        // æ— è®ºæ˜¯å¦æ›´æ–°ï¼Œç¦»å¼€åŒæ­¥å—ï¼ˆå¯¹åº” objc_sync_exitï¼‰
    }

    // æ±‡ç¼–åœ¨é€€å‡ºåŒæ­¥å—åä¼šå‘é€ä¸€ä¸ªé€šçŸ¥ï¼škgDeviceFingerprintIDUpdate
    [[NSNotificationCenter defaultCenter] postNotificationName:@"kgDeviceFingerprintIDUpdate" object:nil];
}

âœ…
- [KGDeviceFPManager getDeviceFingerprintID]
- (NSString *)getDeviceFingerprintID {
    NSString *result = nil;
    // local cache object (obj) stored in instance (X20/X21 åœ¨æ±‡ç¼–é‡Œä»£è¡¨ obj/cache)
    objc_sync_enter(self); // j__objc_sync_enter

    NSString *cached = self->_cachedDeviceFingerprint; // ä»å®ä¾‹/é™æ€å­—æ®µè¯»å‡º
    if (cached && ![cached isEqualToString: SOME_SENTINEL_STRING ]) {
        result = [cached copy];
        objc_sync_exit(self);
        [cached release];
        return[result autorelease]; // å®é™…ç”±ç¼–è¯‘å™¨å¤„ç†
    }

    // cached ä¸å¯ç”¨ï¼Œå°è¯•ä» ConfigProtocol è·å–
    NSString *cfgVal = [ConfigProtocol getDeviceFingerprintID];
    if (cfgVal && ![cfgVal isEqualToString: SOME_SENTINEL_STRING ]) {
        // cfgVal æœ‰æ•ˆ
        // å¯èƒ½ç›´æ¥ç”¨ cfgVal
    } else {
        // cfgVal æ— æ•ˆï¼Œå°è¯•ä» Keychain è¯»å–
        NSString *kc = [UICKeyChainStore stringForKey:@"DeviceFingerprintID"];
        if (kc && ![kc isEqualToString: SOME_SENTINEL_STRING ]) {
            cfgVal = kc;
        } else {
            cfgVal = SOME_SENTINEL_STRING; // ä¾‹å¦‚ nil æˆ– @"-"
        }
    }

    // æŠŠè¯»å–åˆ°çš„å€¼å†™å›ç¼“å­˜ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰
    self->_cachedDeviceFingerprint = [cfgVal copy];
    objc_sync_exit(self);

    // å¦‚æœæœ€ç»ˆä¸ºç©ºæˆ– isEmpty -> è¿”å› @"-"
    if ([StringTool isEmptyStr:cfgVal]) {
        return @"-";
    } else {
        return [cfgVal copy]; // è¿”å›æ‹·è´
    }
}

âœ…
-[KGDeviceFPManager setDeviceFingerprintID:]
- (void)setDeviceFingerprintID:(NSString *)id{
    NSString *input = [HippyI18nUtils copy:id];

    // é»˜è®¤å­—ç¬¦ä¸²ï¼šstru_10F8E5610 â†’ asc_11331B4F0 å¤„çš„ CFString
    NSString *defaultStr = (NSString *)CFSTRING_AT(stru_10F8E5610);

    // X19 = (input == nil ? defaultStr : input)
    NSString *value = (input == nil ? defaultStr : input);

    // å†™å…¥ ConfigProtocol
    [ConfigProtocol setDeviceFingerprintID:value];

    // å†™å…¥ Keychain:  UICKeyChainStore[@"DeviceFingerprintID"] = value;
    [UICKeyChainStore setString:value forKey:@"DeviceFingerprintID"];

    // ä¸‹é¢å¤„ç†å†…éƒ¨å±æ€§ self->_deviceFingerprintID (ä½äº offset 0x50)
    NSString **slot = (NSString **)((uint8_t *)self + 0x50);

    if (*slot == nil) {                         // åŸæ¥æ˜¯ç©º
        if (![StringTool isEmptyStr:value]) {   // ä¸” value éç©º
            *slot = value;                      // storeStrong
        }
    }

    // å†æ‰§è¡Œä¸€æ¬¡é€»è¾‘åˆ†æ”¯ï¼Œåˆ¤æ–­å€¼æ˜¯å¦å˜åŒ–
    NSString *copyId = [HippyI18nUtils copy:id];
    @synchronized(copyId) {
        if (![StringTool isEmptyStr:value]) {
            NSString *old = *slot;              // load [X21,#8]!
            if (![value isEqualToString:old]) { // ä¸ä¸€æ · â†’ æ›¿æ¢
                *slot = value;                  // storeStrong
            }
        }
    }
    [copyId release];

    // å‘é€šçŸ¥ kgDeviceFingerprintIDUpdate
    NSNotificationCenter *nc = [NSNotificationCenter defaultCenter];
    [nc postNotificationName:@"kgDeviceFingerprintIDUpdate"
                      object:nil];

    [value release];
}

+[ConfigProtocol setDeviceFingerprintID:0x28059b210]
  9207 ms  ğŸ‘‰1stg4N3Oz1xX2G0LS10bHT9Kï¼ˆ__NSCFStringï¼‰
  9210 ms  ğŸ‘ˆ: 1stg4N3Oz1xX2G0LS10bHT9Kï¼ˆ__NSCFStringï¼‰






# mark --------------




  